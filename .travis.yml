language: php
php:
  - '5.6'
  - '7.0'
  - '7.1'
install:
  - ant clean
  - ant build
script:
  - ant test
before_deploy:
  - ant statistics
  - wget https://github.com/satooshi/php-coveralls/releases/download/v1.0.1/coveralls.phar
  - php coveralls.phar -v
  - tar -zcvf build/phpdox.tar.gz build/phpdox
  - tar -zcvf build/coverage.tar.gz build/coverage
deploy:
  provider: releases
  api_key:
    secure: 7660fedf15499100625c112704fe2cc2ba442926
  file:
    - build/gitlab-client.phar
  skip_cleanup: true
  on:
    tags: true